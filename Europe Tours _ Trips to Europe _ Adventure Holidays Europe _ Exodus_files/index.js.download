(()=>{"use strict";const{exodus:e}=window,t="ex_data_locale_switcher";function o(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,r)}return o}function r(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t,o){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var r=o.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}const{persist:l,create:c,stores:n}=window.zustand,s={currentLocale:"gb",previouslyClosed:!1,showLocaleSwitcher:!1,headerTopPosition:"0px",geolocation:null,selectedLocaleUrl:"",delay:0},a=["previouslyClosed"],u=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;p({currentLocale:"currentLocale"in window.exodus?window.exodus.currentLocale:"gb",delay:e||0})},d=e=>{e.target.value&&p({selectedLocaleUrl:e.target.value})},h=c(l((()=>r(r({},s),{},{initialize:u,setSelectedLocaleUrl:d})),{name:t,partialize:e=>{const t={};return a.forEach((o=>{t[o]=e[o]})),t}})),{setState:p}=h;n[t]=h;const{customElements:w,HTMLElement:v}=window,{getState:y,setState:f,subscribe:L}=h;w.define("ex-locale-switcher",class extends v{constructor(){super();const{initialize:e,previouslyClosed:t,setSelectedLocaleUrl:o}=y();if(t)return;L(this.update.bind(this));const r=parseInt(this.getAttribute("delay"));this.localePickerElement=this.querySelector(".ex-locale-switcher__select"),this.headerElement=document.querySelector(".header-main");const i=this.querySelector(".ex-locale-switcher__update-button"),l=this.querySelector(".ex-locale-switcher__close");e(r),this.localePickerElement.addEventListener("change",(e=>o(e))),l.addEventListener("click",(e=>this.closeLocaleSwitcher(e))),i.addEventListener("click",(e=>this.visitLocaleUrl(e))),document.defaultView.addEventListener("resize",function(e){let t,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300;return function(){for(var r=arguments.length,i=new Array(r),l=0;l<r;l++)i[l]=arguments[l];clearTimeout(t),t=setTimeout((()=>{e.apply(void 0,i)}),o)}}((()=>this.setHeaderTopPosition()),100)),document.defaultView.addEventListener("ex.visitor-geolocated",(e=>this.handleGeoLocated(e)))}update(e){const{showLocaleSwitcher:t,previouslyClosed:o,selectedLocaleUrl:r}=e;t&&!o&&(this.style.display="flex"),o&&this.remove(),r&&(this.localePickerElement.value=r)}handleGeoLocated(e){var t,o;f({geolocation:null!==(t=null==e||null===(o=e.detail)||void 0===o||null===(o=o.visitor)||void 0===o?void 0:o.geolocation)&&void 0!==t?t:null}),this.setSelectedLocaleUrlFromLocation()}setSelectedLocaleUrlFromLocation(){const{currentLocale:e,geolocation:t,delay:o}=y();if(!this.localePickerElement||!t||!("country"in t)||""===t.country||e===t.country)return;const r=this.localePickerElement.querySelector('[data-locale="'.concat(t.country,'"]'));r&&r.value&&(f({selectedLocaleUrl:r.value}),setTimeout((()=>this.showLocaleSwitcher()),o))}showLocaleSwitcher(){f({showLocaleSwitcher:!0}),this.setHeaderTopPosition()}setHeaderTopPosition(){var e;const{showLocaleSwitcher:t}=y(),o=window.getComputedStyle(document.body),r=null!==(e=this.scrollHeight)&&void 0!==e?e:0,i=o.getPropertyValue("--wp-admin-bar-height")||0,l=t?parseInt(r)+parseInt(i):parseInt(i);f({headerTopPosition:"".concat(l,"px")})}closeLocaleSwitcher(){f({previouslyClosed:!0,showLocaleSwitcher:!1}),this.setHeaderTopPosition()}visitLocaleUrl(){const{selectedLocaleUrl:e}=y();window.location.href=e,this.closeLocaleSwitcher()}})})();